/**
 * Agent Studio - Theme Overrides & Custom Styles
 */

/* React Flow Overrides */
.studio-canvas .react-flow__controls { box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.3) !important; }
.studio-canvas .react-flow__controls-button { background: rgba(22, 27, 34, 0.9) !important; border-bottom: 1px solid rgba(48, 54, 61, 0.5) !important; fill: #8B929E !important; }
.studio-canvas .react-flow__controls-button:hover { background: rgba(28, 33, 40, 1) !important; fill: white !important; }
.studio-canvas .react-flow__controls-button:first-child { border-top-left-radius: 8px !important; border-top-right-radius: 8px !important; }
.studio-canvas .react-flow__controls-button:last-child { border-bottom-left-radius: 8px !important; border-bottom-right-radius: 8px !important; border-bottom: none !important; }
.studio-canvas .react-flow__edge-path { stroke: #484F58 !important; stroke-width: 2 !important; }
.studio-canvas .react-flow__edge.selected .react-flow__edge-path { stroke: #3C5AFE !important; }
.studio-canvas .react-flow__node { cursor: grab; }
.studio-canvas .react-flow__node:active { cursor: grabbing; }
.studio-canvas .react-flow__node.dragging { z-index: 1000 !important; box-shadow: 0 8px 24px rgba(0, 0, 0, 0.4); }

/* Builder Node Accents */
.builder-node { transition: all 0.2s ease; }
.builder-node-agent { min-width: 260px; min-height: 120px; box-shadow: 0 4px 16px rgba(0, 0, 0, 0.3); }
.builder-group-node { box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2); }
.builder-node-persona { border-left: 3px solid rgba(168, 85, 247, 0.6) !important; }
.builder-node-channel-whatsapp { border-left: 3px solid rgba(37, 211, 102, 0.6) !important; }
.builder-node-channel-telegram { border-left: 3px solid rgba(0, 136, 204, 0.6) !important; }
.builder-node-channel-playground { border-left: 3px solid rgba(60, 90, 254, 0.6) !important; }
.builder-node-channel-default { border-left: 3px solid rgba(139, 146, 158, 0.6) !important; }
.builder-node-skill { border-left: 3px solid rgba(20, 184, 166, 0.6) !important; }
.builder-node-tool { border-left: 3px solid rgba(249, 115, 22, 0.6) !important; }
.builder-node-sentinel { border-left: 3px solid rgba(239, 68, 68, 0.6) !important; }
.builder-node-knowledge { border-left: 3px solid rgba(139, 92, 246, 0.6) !important; }
.builder-node-memory { border-left: 3px solid rgba(59, 130, 246, 0.6) !important; }

/* Palette Styles */
.studio-palette { scrollbar-width: thin; scrollbar-color: rgba(139, 146, 158, 0.3) transparent; }
.studio-palette::-webkit-scrollbar { width: 4px; }
.studio-palette::-webkit-scrollbar-track { background: transparent; }
.studio-palette::-webkit-scrollbar-thumb { background-color: rgba(139, 146, 158, 0.3); border-radius: 4px; }
.palette-item { cursor: grab; transition: all 0.15s ease; user-select: none; }
.palette-item:hover { background: rgba(60, 90, 254, 0.08); }
.palette-item:active { cursor: grabbing; opacity: 0.6; }
.palette-item.attached { background: rgba(60, 90, 254, 0.06); }
.palette-item.disabled { cursor: not-allowed; opacity: 0.4; }

/* Canvas Drop Zone */
.studio-canvas.drag-over { outline: 2px dashed rgba(60, 90, 254, 0.5); outline-offset: -2px; background: rgba(60, 90, 254, 0.03); }

/* Builder Group Node */
.builder-group-node { transition: all 0.2s ease; cursor: default; }
.builder-group-node.group-channels { border-left: 3px solid rgba(59, 130, 246, 0.6) !important; }
.builder-group-node.group-skills { border-left: 3px solid rgba(20, 184, 166, 0.6) !important; }
.builder-group-node.group-tools { border-left: 3px solid rgba(249, 115, 22, 0.6) !important; }
.builder-group-node.group-knowledge { border-left: 3px solid rgba(139, 92, 246, 0.6) !important; }
.builder-group-node.expanded { box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3); }
.builder-group-node .expand-button { transition: transform 0.2s ease; }

/* Group count badge */
.group-count-badge { font-size: 10px; font-weight: 600; padding: 1px 6px; border-radius: 9999px; line-height: 1.4; }

/* Smooth node position transitions for layout switching â€” NOT during drag */
.studio-canvas .react-flow__node { transition: transform 0.3s ease-out; }
.studio-canvas .react-flow__node.dragging { transition: none !important; }

/* Layout Controls Toolbar */
.studio-layout-toolbar {
  position: absolute;
  top: 0.75rem;
  right: 0.75rem;
  z-index: 10;
  display: flex;
  gap: 0.375rem;
}

.studio-layout-btn {
  background: rgba(22, 27, 34, 0.92);
  border: 1px solid rgba(48, 54, 61, 0.6);
  border-radius: 0.375rem;
  padding: 0.375rem 0.625rem;
  font-size: 0.6875rem;
  font-weight: 500;
  color: #8B929E;
  transition: all 0.15s ease;
  display: flex;
  align-items: center;
  gap: 0.375rem;
  cursor: pointer;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
  line-height: 1;
}

.studio-layout-btn:hover {
  border-color: #8B929E;
  color: white;
  background: rgba(28, 33, 40, 1);
}

/* Save Button */
@keyframes save-pulse { 0%, 100% { box-shadow: 0 0 0 0 rgba(60, 90, 254, 0.4); } 50% { box-shadow: 0 0 0 6px rgba(60, 90, 254, 0); } }
.save-button-dirty { animation: save-pulse 2s ease-in-out infinite; }

/* Node Config Panel - Slide-out */
.node-config-panel {
  position: absolute;
  right: 0.5rem;
  top: 0.5rem;
  bottom: 0.5rem;
  z-index: 20;
  width: 320px;
  background: rgba(13, 17, 23, 0.95);
  backdrop-filter: blur(8px);
  border: 1px solid rgba(48, 54, 61, 0.6);
  border-radius: 0.5rem;
  display: flex;
  flex-direction: column;
  overflow: hidden;
  transform: translateX(340px);
  transition: transform 0.25s ease-out;
}
.node-config-panel.open {
  transform: translateX(0);
}

.node-config-panel-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 0.75rem 1rem;
  border-bottom: 1px solid rgba(48, 54, 61, 0.5);
  flex-shrink: 0;
}

.node-config-panel-body {
  flex: 1;
  overflow-y: auto;
  padding: 1rem;
  scrollbar-width: thin;
  scrollbar-color: rgba(139, 146, 158, 0.3) transparent;
}
.node-config-panel-body::-webkit-scrollbar { width: 4px; }
.node-config-panel-body::-webkit-scrollbar-track { background: transparent; }
.node-config-panel-body::-webkit-scrollbar-thumb { background-color: rgba(139, 146, 158, 0.3); border-radius: 4px; }

/* Config form fields */
.config-field { margin-bottom: 0; }
.config-field label {
  display: block;
  font-size: 0.6875rem;
  font-weight: 500;
  color: #8B929E;
  margin-bottom: 0.375rem;
  text-transform: uppercase;
  letter-spacing: 0.025em;
}
.config-field .field-help {
  font-size: 0.6875rem;
  color: rgba(139, 146, 158, 0.7);
  margin-top: 0.25rem;
  line-height: 1.4;
}

.config-input {
  width: 100%;
  padding: 0.5rem 0.75rem;
  background: rgba(22, 27, 34, 0.8);
  border: 1px solid rgba(48, 54, 61, 0.6);
  border-radius: 0.375rem;
  color: white;
  font-size: 0.8125rem;
  transition: border-color 0.15s ease;
}
.config-input:focus {
  outline: none;
  border-color: #3C5AFE;
}
.config-input::placeholder {
  color: rgba(139, 146, 158, 0.5);
}

.config-select {
  width: 100%;
  padding: 0.5rem 0.75rem;
  background: rgba(22, 27, 34, 0.8);
  border: 1px solid rgba(48, 54, 61, 0.6);
  border-radius: 0.375rem;
  color: white;
  font-size: 0.8125rem;
  appearance: none;
  cursor: pointer;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 24 24' fill='none' stroke='%238B929E' stroke-width='2'%3E%3Cpath d='M6 9l6 6 6-6'/%3E%3C/svg%3E");
  background-repeat: no-repeat;
  background-position: right 0.75rem center;
  padding-right: 2rem;
}
.config-select:focus {
  outline: none;
  border-color: #3C5AFE;
}
.config-select option {
  background: #161B22;
  color: white;
}

/* Toggle switch */
.config-toggle {
  position: relative;
  width: 36px;
  height: 20px;
  border-radius: 10px;
  background: rgba(48, 54, 61, 0.8);
  border: 1px solid rgba(48, 54, 61, 0.6);
  cursor: pointer;
  transition: all 0.2s ease;
  padding: 0;
  flex-shrink: 0;
}
.config-toggle.active {
  background: rgba(60, 90, 254, 0.6);
  border-color: rgba(60, 90, 254, 0.8);
}
.config-toggle-thumb {
  position: absolute;
  top: 2px;
  left: 2px;
  width: 14px;
  height: 14px;
  border-radius: 50%;
  background: white;
  transition: transform 0.2s ease;
  pointer-events: none;
}
.config-toggle.active .config-toggle-thumb {
  transform: translateX(16px);
}
